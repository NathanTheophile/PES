[gd_scene load_steps=6 format=2]

[ext_resource path="res://skills/HelperWindows/Push.tscn" type="PackedScene" id=1]
[ext_resource path="res://areas/03 - Buggy/Cabaji/(Enemy) Top.tscn" type="PackedScene" id=2]
[ext_resource path="res://skills/SkillScript.gd" type="Script" id=3]
[ext_resource path="res://areas/03 - Buggy/Cabaji/TopP.tscn" type="PackedScene" id=4]

[sub_resource type="GDScript" id=1]
script/source = "extends Node

# targetArray = Array contendo as posições que esse feitiço atingiu
#               A célula central será contida em um Array sozinha, para fácil identificação
var skill
func effects(targetArray):
	skill = get_parent()

	
	BattleMechanics.playAnimEntity(skill.caster, \"Tops\")
	
	yield(get_tree().create_timer(0.5),\"timeout\")
	var cells = BattleMechanics.getCellInRadius(skill.caster.posit,4,true,2)
	for i in cells:
		summ(i)

func summ(i):
	BattleMechanics.shootProjectile(skill.visuals[0],skill.caster.posit, i)
	yield(get_tree().create_timer(1),\"timeout\")
	var t = BattleMechanics.summonMonster(skill.states[0],i)
	BattleMechanics.bounceTgt(t)
	skill.caster.connect(\"killed\",BattleMechanics.getState(t,\"Top\").get_node(\"Effects\"),\"kill\")
"

[node name="Skill" type="Node2D"]
script = ExtResource( 3 )
skillName = "Dance of the Tops"
rangeMin = 0
rangeMax = 0
linear = true
sight = true
usePerTgt = 1
visuals = [ ExtResource( 4 ) ]
effects = SubResource( 1 )
states = [ ExtResource( 2 ) ]
helpertext = [ ExtResource( 1 ) ]

[node name="Effects" type="Node" parent="."]
