[gd_scene load_steps=6 format=2]

[ext_resource path="res://skills/SkillScript.gd" type="Script" id=1]
[ext_resource path="res://characters/001 - Luffy/gatling.tscn" type="PackedScene" id=2]
[ext_resource path="res://characters/001 - Luffy/gatling2.tscn" type="PackedScene" id=3]
[ext_resource path="res://skills/icons/atk.png" type="Texture" id=4]

[sub_resource type="GDScript" id=1]
script/source = "extends Node

# targetArray = Array contendo as posições que esse feitiço atingiu
#               A célula central será contida em um Array sozinha, para fácil identificação
var skill
func effects(targetArray):
	skill = get_parent()
	var d = skill.caster.direction
	BattleMechanics.playAnimEntity(skill.caster, \"Gatling-Start\")
	
	yield(get_tree().create_timer(0.6),\"timeout\")
	BattleMechanics.playAnimEntity(skill.caster, \"Gatling-Mid\")
	
	var tgt = BattleMechanics.getEntityAt(targetArray[0])
	if tgt:
		
		for i in 6:
			BattleMechanics.playAnim(skill.visuals[0 if d in [Vector2(1,0),Vector2(0,1)] else 1],targetArray[0], false if abs(d.x)>abs(d.y) else true)
			BattleMechanics.dealDmg([skill.base,\"n\"],tgt,skill.caster)
			AM.play(skill.caster.audioEX[2], {\"randp\": 1.3})
			yield(get_tree().create_timer(0.1),\"timeout\")
		
	yield(get_tree().create_timer(0.3),\"timeout\")

	BattleMechanics.playAnimEntity(skill.caster, \"Gatling-End\")
	AM.play(skill.caster.audioEX[2], {\"randp\": 1.3})
	
			
	
	
	
"

[node name="Skill" type="Node2D"]
script = ExtResource( 1 )
skillName = "Gomu no Gatling"
description = "[b]{b}[/b] [img]res://skills/sword.png[/img] 6 times.
"
icon1 = ExtResource( 4 )
base = 4
apCost = 1
element = 1
linear = true
sight = true
usePerTurn = 5
visuals = [ ExtResource( 2 ), ExtResource( 3 ) ]
effects = SubResource( 1 )

[node name="Effects" type="Node" parent="."]
